<!DOCTYPE html><html><head><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-121177820-1"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-121177820-1');</script><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="/static/css/app.d891e5fc5dac5da8bde8627887e4cc66.css" rel="stylesheet"><title>SharePoint - Exporting Term Sets | Mercedes Bernard</title><meta name="twitter:card" data-vmid="twitter:card" content="summary" data-vue-meta="true"><meta name="twitter:site" data-vmid="twitter:site" content="@mercedescodes" data-vue-meta="true"><meta name="twitter:creator" data-vmid="twitter:creator" content="@mercedescodes" data-vue-meta="true"><meta property="og:type" data-vmid="og:type" content="article" data-vue-meta="true"><meta property="og:site_name" data-vmid="og:site_name" content="Mercedes Bernard" data-vue-meta="true"><meta name="description" data-vmid="description" content="" data-vue-meta="true"><meta name="twitter:description" data-vmid="twitter:description" content="" data-vue-meta="true"><meta property="og:url" data-vmid="og:url" content="http://www.mercedesbernard.com/blog/sharepoint-exporting-term-sets/" data-vue-meta="true"><meta property="og:description" data-vmid="og:description" content="" data-vue-meta="true"><meta name="og:title" data-vmid="og:title" content="SharePoint - Exporting Term Sets" data-vue-meta="true"><meta name="twitter:title" data-vmid="twitter:title" content="SharePoint - Exporting Term Sets" data-vue-meta="true"><meta property="og:title" data-vmid="og:title" content="SharePoint - Exporting Term Sets" data-vue-meta="true"></head><body><div id="app"><div class="ContentLayout"><main class="BlogPost" urlsegment="sharepoint-exporting-term-sets"><header data-v-828d61ec="" class="PageHeader PageHeader--purple PageHeader--short"><!----> <div data-v-828d61ec="" class="PageHeader-text"><div data-v-828d61ec="" class="PageHeader-decorativeHeader"><h2 data-v-828d61ec="">May 01 2013</h2></div> <div data-v-828d61ec="" class="PageHeader-titleHeader"><h1 data-v-828d61ec="">SharePoint - Exporting Term Sets</h1></div></div> <nav data-v-828d61ec="" class="Navigation"><ul class="Navigation-navLinks"><li class="Navigation-navLink"><div><a href="/" class="router-link-active"><div class="Navigation-title"><span>Home</span></div> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTU0cHgiIGhlaWdodD0iMTUzcHgiIHZpZXdCb3g9IjAgMCAxNTQgMTUzIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0OS4xICg1MTE0NykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+R3JvdXAgNDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJSZXNvdXJjZS1TZXQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJHcm91cC00IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjAwMDAwMCwgMi4wMDAwMDApIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMSI+CiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJQYXRoLTE0IiBwb2ludHM9IjE4LjY3ODM0MDMgMTQ5LjkwNjYxOSAxOC42NzgzNDAzIDY4LjQwNDg1MzYgMTMxLjMyNTU5MSA2OC40MDQ4NTM2IDEzMS4zMjU1OTEgMTQ5LjkwNjYxOSI+PC9wb2x5Z29uPgogICAgICAgICAgICA8cG9seWxpbmUgaWQ9IlBhdGgtMTUiIHBvaW50cz0iNTYuMTM2MjEwOSAxNDkuOTA2NjE5IDU2LjEzNjIxMDkgMTEzLjM5NTkyMyA4Ny45ODY1MzAyIDExMy4zOTU5MjMgODcuOTg2NTMwMiAxNDkuOTA2NjE5Ij48L3BvbHlsaW5lPgogICAgICAgICAgICA8cG9seWxpbmUgaWQ9IlBhdGgtMTYiIHBvaW50cz0iNTYuMTM2MjEwOSAxMTMuNTgzMDA0IDU2LjEzNjIxMDkgMTAxLjczMDUzMiA4Ny45ODY1MzAyIDEwMS43MzA1MzIgODcuOTg2NTMwMiAxMTMuNTgzMDA0Ij48L3BvbHlsaW5lPgogICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0xOCIgcG9pbnRzPSIxOC43MjE5MjQgNjguNDQwNTUwMyA3NS4wOTcxNTY2IDEzLjAxMTk5NjIgMTMxLjQ3MjM4OSA2OC40NDA1NTAzIj48L3BvbHlnb24+CiAgICAgICAgICAgIDxwb2x5bGluZSBpZD0iUGF0aC0yMCIgcG9pbnRzPSIxOC43OTA4MTY5IDY4LjQzMjIwMDMgOS4xMjc1MzI5MiA3OC40ODY3NDA2IDAuMDAzNTIwMTgwOTcgNzEuMjAzNzQ5NiA3NS40MzY4NDAzIDAuMDc5OTk5ODY3MiAxNDkuOTU1Nzc0IDcxLjIwMzc0OTYgMTQwLjc4NjA4NiA3OC40ODY3NDA2IDEzMS40MTQ2NTEgNjguNDMyMjAwMyI+PC9wb2x5bGluZT4KICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC02IiBjeD0iMTA5LjkwMDU5MiIgY3k9IjkxLjQ3NjQ0MiIgcj0iMi44MjM1Mjk0MSI+PC9jaXJjbGU+CiAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtNiIgY3g9Ijk5LjYyNzE4MjQiIGN5PSI5MS40NzY0NDIiIHI9IjIuODIzNTI5NDEiPjwvY2lyY2xlPgogICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsLTYiIGN4PSI1OS4xMDE1MzEiIGN5PSIxMzUuNjQ2NzczIiByPSIxIj48L2NpcmNsZT4KICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC02IiBjeD0iMTIwLjE3NTEyOCIgY3k9IjkxLjQ3NjQ0MiIgcj0iMi44MjM1Mjk0MSI+PC9jaXJjbGU+CiAgICAgICAgICAgIDxwb2x5bGluZSBpZD0iUGF0aC0yMSIgcG9pbnRzPSIxMTkuNDg3NjU0IDQyLjE4Mjg5NTMgMTE5LjQ4NzY1NCAxOS4yNDkxNDE4IDEzMC41OTA0NDIgMTkuMjQ5MTQxOCAxMzAuNTkwNDQyIDUyLjc3MzAwNTYiPjwvcG9seWxpbmU+CiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJQYXRoLTE5IiBwb2ludHM9IjY1LjI5NjgwMzcgNDAuOTU4NzM3OSA2NS4yOTY4MDM3IDYwLjAxNzU2MTQgODQuMzU1NjI3MiA2MC4wMTc1NjE0IDg0LjM1NTYyNzIgNDAuOTU4NzM3OSI+PC9wb2x5Z29uPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+" class="Navigation-icon"></a> <!----></div></li> <li class="Navigation-navLink"><div><a href="/about" class=""><div class="Navigation-title"><span>About</span></div> <img src="//images.ctfassets.net/kueynwv98jit/2LWqdeu7xCw0uyqKUmkAOA/3045b0e74b2f9d88e504ac7309a98c9f/AboutIcon.svg" class="Navigation-icon"></a> <!----></div></li><li class="Navigation-navLink"><div><a href="/connect" class=""><div class="Navigation-title"><span>Connect</span></div> <img src="//images.ctfassets.net/kueynwv98jit/1rTlONw1hmcCQaWmk60g8a/fafe83d4b36be54929c683fff763b5ea/ConnectIcon.svg" class="Navigation-icon"></a> <!----></div></li><li class="Navigation-navLink"><div><a href="/blog" class="router-link-active"><div class="Navigation-title"><span>Blog</span></div> <img src="//images.ctfassets.net/kueynwv98jit/3HoJpizH9ewWec80OyyYqo/7370fbd9da0ca8bd4ebde5a063b9c579/BlogIcon.svg" class="Navigation-icon"></a> <!----></div></li><li class="Navigation-navLink"><div><!----> <a href="https://www.etsy.com/shop/blinddogyarns?ref=mercedesbernard" target="_blank"><div class="Navigation-title"><span>Shop</span></div> <img src="//images.ctfassets.net/kueynwv98jit/5PDAZgLTjiuC2Ka44u68qY/1986ce98446ee47a7fadf1e3972f6bac/ShopIcon.svg" class="Navigation-icon"></a></div></li></ul></nav></header> <div class="BlogPost-content"><div class="PageContent"><p><span>3 min read</span></p> <div class="Markdown"><p>This post originally appeared on the <a href="https://blogs.perficient.com/2013/05/01/exporting-term-sets/">Perficient blog</a></p>
<p>I don’t know about you, but I really wish there was a way to export managed metadata in SharePoint, especially since SharePoint teases you with the ‘Import Term Set’ option. To get around this I’ve written a little script to export all of the term sets in a term store (easily customizable to just export the term sets in a particular group or just 1 term set if you choose to go that route) to a CSV file that follows the Microsoft formatting convention needed to use the Import Term Set option.  It’s not perfect, but it definitely gets the job done.  I thought I’d share it with you all to hopefully make someone else’s life a little easier.
For information on the formatting of the CSV file for import please see <a href="https://docs.microsoft.com/en-us/previous-versions/office/sharepoint-server-2010/ee424396(v=office.14)">this Technet article</a>.</p>
<h4>Code (Powershell)</h4>
<pre><code> Add-PSSnapin "Microsoft.SharePoint.PowerShell"
 
 function Get-TermSetsCSV() {
     param($SiteUrl, $CSVOutput)
 
     $empty = ""

     $taxonomySite = Get-SPSite -Identity $SiteUrl

     #Connect to Term Store in the Managed Metadata Service Application
     $taxonomySession = Get-SPTaxonomySession -site $taxonomySite
     $taxonomyTermStore =  $taxonomySession.TermStores | Select Name
     $termStore = $taxonomySession.TermStores[$taxonomyTermStore.Name]
 
     foreach ($group in $termStore.Groups)
     {
         foreach($termSet in $group.TermSets)
         {
             $terms = @()

             #The path and file name, in this case I d\TermSet\TermSetName.csv
             $CSVFile = $CSVOutput + '\' + $termSet.Name + '.csv'

             #From Tec The first line of the file must contain 12 items separated by commas
             $firstLine = New-TermLine -TermSetName $termSet.Name -TermSetDescription $empty -LCID $empty -AvailableForTagging "TRUE" -TermDescription $empty -Level1 $empty -Level2 $empty -Level3 $empty -Level4 $empty -Level5 $empty -Level6 $empty -Level7 $empty
             $terms+=$firstLine

             #Now we start to add a line in the file for each term in the term set
             foreach ($term in $termSet.GetAllTerms())
             {

                 $tempTerm = $term
                 $counter = 0
                 $tempTerms = @("","","","","","","")
 
                 #this while loop makes sure you are using the root term then counts how many child terms there are 
                 while (!$tempTerm.IsRoot)
                 {
                     $tempTerm = $tempTerm.Parent
                     $counter = $counter + 1
                 }

                 $start = $counter

                 #this makes sure that any columns that would need to be empty are empty
                 #i.e. if the current term is 3 levels deep, then the 4th, 5th, and 6th level will be empty
                 while ($counter -le 6)
                 {
                     $tempTerms[$counter] = $empty
                     $counter = $counter + 1
                 }

                 #start with the current term
                 $tempTerm = $term

                 #fill in the parent terms of the current term (there should never be children of the current term--the child term will have its own line in the CSV)
                 while ($start -ge 0)
                 {
                     $tempTerms[$start] = $tempTerm.Name
                     $tempTerm = $tempTerm.Parent
                     $start = $start - 1
                 }

                 #create a new line in the CSV file
                 $CSVLine = New-TermLine -TermSetName $empty -TermSetDescription $empty -LCID $empty -AvailableForTagging "TRUE" -TermDescription $empty -Level1 $tempTerms[0] -Level2 $tempTerms[1] -Level3 $tempTerms[2] -Level4 $tempTerms[3] -Level5 $tempTerms[4] -Level6 $tempTerms[5] -Level7 $tempTerms[6]

                 #add the new line
                 $terms+=$CSVLine
             }

             #export all of the terms to a CSV file
             $terms | Export-Csv $CSVFile -notype
         }
     }
     $taxonomySite.dispose()
 }

 #constructor
 function New-TermLine() {
     param($TermSetName, $TermSetDescription, $LCID, $AvailableForTagging, $TermDescription, $Level1, $Level2, $Level3, $Level4, $Level5, $Level6, $Level7)
 
     $term = New-Object PSObject

     $term | Add-Member -Name "TermSetName" -MemberType NoteProperty -Value $TermSetName
     $term | Add-Member -Name "TermSetDescription" -MemberType NoteProperty -Value $TermSetDescription
     $term | Add-Member -Name "LCID" -MemberType NoteProperty -Value $LCID
     $term | Add-Member -Name "AvailableForTagging" -MemberType NoteProperty -Value $AvailableForTagging
     $term | Add-Member -Name "TermDescription" -MemberType NoteProperty -Value $TermDescription
     $term | Add-Member -Name "Level1" -MemberType NoteProperty -Value $Level1
     $term | Add-Member -Name "Level2" -MemberType NoteProperty -Value $Level2
     $term | Add-Member -Name "Level3" -MemberType NoteProperty -Value $Level3
     $term | Add-Member -Name "Level4" -MemberType NoteProperty -Value $Level4
     $term | Add-Member -Name "Level5" -MemberType NoteProperty -Value $Level5
     $term | Add-Member -Name "Level6" -MemberType NoteProperty -Value $Level6
     $term | Add-Member -Name "Level7" -MemberType NoteProperty -Value $Level7
 
     return $term
 }
 
 Get-TermSetsCSV -SiteUrl "Your Site URL" -CSVOutput "C:\TermSet"
</code></pre>
</div> <br> <p class="BlogPost-publishDate"><em>Published May 01 2013</em></p></div></div></main></div></div><script type="text/javascript" src="/static/js/manifest.2ae2e69a05c33dfc65f8.js"></script><script type="text/javascript" src="/static/js/vendor.bdfbbe384b0395b368c1.js"></script><script type="text/javascript" src="/static/js/app.ab240af6d075b4ac57ad.js"></script></body></html>