<!DOCTYPE html><html><head><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-121177820-1"></script><script>window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-121177820-1');</script><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link href="/static/css/app.d891e5fc5dac5da8bde8627887e4cc66.css" rel="stylesheet"><title>SharePoint 2013 Managed Navigation: Pros, Cons, and Code | Mercedes Bernard</title><meta name="twitter:card" data-vmid="twitter:card" content="summary" data-vue-meta="true"><meta name="twitter:site" data-vmid="twitter:site" content="@mercedescodes" data-vue-meta="true"><meta name="twitter:creator" data-vmid="twitter:creator" content="@mercedescodes" data-vue-meta="true"><meta property="og:type" data-vmid="og:type" content="article" data-vue-meta="true"><meta property="og:site_name" data-vmid="og:site_name" content="Mercedes Bernard" data-vue-meta="true"><meta name="description" data-vmid="description" content="" data-vue-meta="true"><meta name="twitter:description" data-vmid="twitter:description" content="" data-vue-meta="true"><meta property="og:url" data-vmid="og:url" content="http://www.mercedesbernard.com/blog/sharepoint-managed-navigation/" data-vue-meta="true"><meta property="og:description" data-vmid="og:description" content="" data-vue-meta="true"><meta name="og:title" data-vmid="og:title" content="SharePoint 2013 Managed Navigation: Pros, Cons, and Code" data-vue-meta="true"><meta name="twitter:title" data-vmid="twitter:title" content="SharePoint 2013 Managed Navigation: Pros, Cons, and Code" data-vue-meta="true"><meta property="og:title" data-vmid="og:title" content="SharePoint 2013 Managed Navigation: Pros, Cons, and Code" data-vue-meta="true"></head><body><div id="app"><div class="ContentLayout"><main class="BlogPost" urlsegment="sharepoint-managed-navigation"><header data-v-828d61ec="" class="PageHeader PageHeader--purple PageHeader--short"><!----> <div data-v-828d61ec="" class="PageHeader-text"><div data-v-828d61ec="" class="PageHeader-decorativeHeader"><h2 data-v-828d61ec="">May 02 2013</h2></div> <div data-v-828d61ec="" class="PageHeader-titleHeader"><h1 data-v-828d61ec="">SharePoint 2013 Managed Navigation: Pros, Cons, and Code</h1></div></div> <nav data-v-828d61ec="" class="Navigation"><ul class="Navigation-navLinks"><li class="Navigation-navLink"><div><a href="/" class="router-link-active"><div class="Navigation-title"><span>Home</span></div> <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTU0cHgiIGhlaWdodD0iMTUzcHgiIHZpZXdCb3g9IjAgMCAxNTQgMTUzIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA0OS4xICg1MTE0NykgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+R3JvdXAgNDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJSZXNvdXJjZS1TZXQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJHcm91cC00IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyLjAwMDAwMCwgMi4wMDAwMDApIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMSI+CiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJQYXRoLTE0IiBwb2ludHM9IjE4LjY3ODM0MDMgMTQ5LjkwNjYxOSAxOC42NzgzNDAzIDY4LjQwNDg1MzYgMTMxLjMyNTU5MSA2OC40MDQ4NTM2IDEzMS4zMjU1OTEgMTQ5LjkwNjYxOSI+PC9wb2x5Z29uPgogICAgICAgICAgICA8cG9seWxpbmUgaWQ9IlBhdGgtMTUiIHBvaW50cz0iNTYuMTM2MjEwOSAxNDkuOTA2NjE5IDU2LjEzNjIxMDkgMTEzLjM5NTkyMyA4Ny45ODY1MzAyIDExMy4zOTU5MjMgODcuOTg2NTMwMiAxNDkuOTA2NjE5Ij48L3BvbHlsaW5lPgogICAgICAgICAgICA8cG9seWxpbmUgaWQ9IlBhdGgtMTYiIHBvaW50cz0iNTYuMTM2MjEwOSAxMTMuNTgzMDA0IDU2LjEzNjIxMDkgMTAxLjczMDUzMiA4Ny45ODY1MzAyIDEwMS43MzA1MzIgODcuOTg2NTMwMiAxMTMuNTgzMDA0Ij48L3BvbHlsaW5lPgogICAgICAgICAgICA8cG9seWdvbiBpZD0iUGF0aC0xOCIgcG9pbnRzPSIxOC43MjE5MjQgNjguNDQwNTUwMyA3NS4wOTcxNTY2IDEzLjAxMTk5NjIgMTMxLjQ3MjM4OSA2OC40NDA1NTAzIj48L3BvbHlnb24+CiAgICAgICAgICAgIDxwb2x5bGluZSBpZD0iUGF0aC0yMCIgcG9pbnRzPSIxOC43OTA4MTY5IDY4LjQzMjIwMDMgOS4xMjc1MzI5MiA3OC40ODY3NDA2IDAuMDAzNTIwMTgwOTcgNzEuMjAzNzQ5NiA3NS40MzY4NDAzIDAuMDc5OTk5ODY3MiAxNDkuOTU1Nzc0IDcxLjIwMzc0OTYgMTQwLjc4NjA4NiA3OC40ODY3NDA2IDEzMS40MTQ2NTEgNjguNDMyMjAwMyI+PC9wb2x5bGluZT4KICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC02IiBjeD0iMTA5LjkwMDU5MiIgY3k9IjkxLjQ3NjQ0MiIgcj0iMi44MjM1Mjk0MSI+PC9jaXJjbGU+CiAgICAgICAgICAgIDxjaXJjbGUgaWQ9Ik92YWwtNiIgY3g9Ijk5LjYyNzE4MjQiIGN5PSI5MS40NzY0NDIiIHI9IjIuODIzNTI5NDEiPjwvY2lyY2xlPgogICAgICAgICAgICA8Y2lyY2xlIGlkPSJPdmFsLTYiIGN4PSI1OS4xMDE1MzEiIGN5PSIxMzUuNjQ2NzczIiByPSIxIj48L2NpcmNsZT4KICAgICAgICAgICAgPGNpcmNsZSBpZD0iT3ZhbC02IiBjeD0iMTIwLjE3NTEyOCIgY3k9IjkxLjQ3NjQ0MiIgcj0iMi44MjM1Mjk0MSI+PC9jaXJjbGU+CiAgICAgICAgICAgIDxwb2x5bGluZSBpZD0iUGF0aC0yMSIgcG9pbnRzPSIxMTkuNDg3NjU0IDQyLjE4Mjg5NTMgMTE5LjQ4NzY1NCAxOS4yNDkxNDE4IDEzMC41OTA0NDIgMTkuMjQ5MTQxOCAxMzAuNTkwNDQyIDUyLjc3MzAwNTYiPjwvcG9seWxpbmU+CiAgICAgICAgICAgIDxwb2x5Z29uIGlkPSJQYXRoLTE5IiBwb2ludHM9IjY1LjI5NjgwMzcgNDAuOTU4NzM3OSA2NS4yOTY4MDM3IDYwLjAxNzU2MTQgODQuMzU1NjI3MiA2MC4wMTc1NjE0IDg0LjM1NTYyNzIgNDAuOTU4NzM3OSI+PC9wb2x5Z29uPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+" class="Navigation-icon"></a> <!----></div></li> <li class="Navigation-navLink"><div><a href="/about" class=""><div class="Navigation-title"><span>About</span></div> <img src="//images.ctfassets.net/kueynwv98jit/2LWqdeu7xCw0uyqKUmkAOA/3045b0e74b2f9d88e504ac7309a98c9f/AboutIcon.svg" class="Navigation-icon"></a> <!----></div></li><li class="Navigation-navLink"><div><a href="/connect" class=""><div class="Navigation-title"><span>Connect</span></div> <img src="//images.ctfassets.net/kueynwv98jit/1rTlONw1hmcCQaWmk60g8a/fafe83d4b36be54929c683fff763b5ea/ConnectIcon.svg" class="Navigation-icon"></a> <!----></div></li><li class="Navigation-navLink"><div><a href="/blog" class="router-link-active"><div class="Navigation-title"><span>Blog</span></div> <img src="//images.ctfassets.net/kueynwv98jit/3HoJpizH9ewWec80OyyYqo/7370fbd9da0ca8bd4ebde5a063b9c579/BlogIcon.svg" class="Navigation-icon"></a> <!----></div></li><li class="Navigation-navLink"><div><!----> <a href="https://www.etsy.com/shop/blinddogyarns?ref=mercedesbernard" target="_blank"><div class="Navigation-title"><span>Shop</span></div> <img src="//images.ctfassets.net/kueynwv98jit/5PDAZgLTjiuC2Ka44u68qY/1986ce98446ee47a7fadf1e3972f6bac/ShopIcon.svg" class="Navigation-icon"></a></div></li></ul></nav></header> <div class="BlogPost-content"><div class="PageContent"><p><span>5 min read</span></p> <div class="Markdown"><p>This post originally appeared on the <a href="https://blogs.perficient.com/2013/05/02/sharepoint-2013-managed-navigation-pros-cons-and-code/">Perficient blog</a></p>
<p>I recently posted a script to export term sets in SharePoint (vetted in both 2010 &amp; 2013).  I was prompted to write that script, because the client I was working on had a very particular (and large!) managed navigation structure that I wanted to replicate across all environments to make testing code much simpler. This was my first experience using 2013’s managed navigation and I wanted to share my thoughts and see if anyone else has had similar/different experiences with it so far.</p>
<p>For those of you that don’t know, managed navigation is new in SharePoint 2013.  It gives you the option to base the navigation on taxonomy rather than “physical” structure.  It uses a dedicated term set for site navigation and the terms correspond to the friendly URL segment created.</p>
<p>For instance, http://site.com/example/of/managed/navigation would correspond to the following term hierarchy:</p>
<blockquote>
<p>example (root term) –&gt; of –&gt; managed –&gt; navigation</p>
</blockquote>
<p>And the term ‘navigation’ would be mapped to the physical URL (the /Pages/page.aspx URL) of the specific page you want shown when a user navigates to that URL.</p>
<p>Managed navigation provides a lot of flexibility for how you want your site organized and optimizes your URLs for SEO.  It makes it possible to move pages across “sites” or locations (if you think of a site in terms of what an end user sees rather than the SharePoint structure for site) without actually moving or touching the physical page.</p>
<p>In my experience, managed navigation is great in certain scenarios and in other instances may not be the best choice.  I’ve briefly outlined the pros and cons that I’ve experienced personally.</p>
<h4>Pros</h4>
<ul>
<li>User Experience: Managed navigation gives your site a consistent, easy URL schema for your end users.  I don’t know about you, but not seeing http://site.com/Pages/AboutUs.aspx and seeing http://site.com/about-us instead just seems so much cleaner and more intuitive, especially as the logical organization gets deeper.</li>
<li>New customization opportunities: Who doesn’t love shiny new toys?? Because the navigation is now taxonomy driven, custom navigation controls are easier to code and maintain (in my opinion) and provide more flexibility.  Navigation terms come with a lot of properties OOTB, but you can also define your own custom properties programmatically or through the UI to use in your custom controls.</li>
</ul>
<h4>Cons</h4>
<ul>
<li>Content authoring: In order to reap the full benefits of SEO optimized friendly URLs, you have to set the “Hide physical URL from search” property to true on every page otherwise search indexes the physical URL and you lose the benefits of the friendly URLs (especially if you have custom controls appearing on friendly URL pages which won’t appear on physical pages).  However, this means that the physical pages are also hidden from search/within the document libraries.  Even though this seems small, if you are a content author sifting through hundreds of pages in a library to edit a single page and can’t use the library’s search bar, this can become a huge pet peeve.</li>
<li>Limited to a single site collection: If you have multiple site collections composing your intranet/extranet/public website, you cannot share a single navigation term set among all of the site collections.  For me, this is a major sore spot as its not possible to share global navigation across site collections, let alone the more granular levels of navigation.  I don’t want to have to maintain multiple copies of a navigation term set manually so that whenever I click a ‘Home’ link across site collections, I go to the same page.</li>
</ul>
<h4>Code (.NET)</h4>
<p>Below are some code samples just to get started using managed navigation programmatically.</p>
<p>I found myself having difficulty trying to figure out how to access the friendly URL for a term, because I couldn’t find the properties or methods I needed on the Term object.  You must first get the NavigationTerm object for the Term, then you can get the friendly URL.</p>
<pre><code>TermSetCollection navTermSets = session.DefaultSiteCollectionTermStore.GetTermSets(NavTermSetName, 1033);
   
//gets the collection of terms starting at the root term 'value'
var termCollection = from allTerms in navTermSets[0].Terms where allTerms.GetDefaultLabel(1033).ToLower() == "value" select allTerms;

if (termCollection != null &amp;&amp; termCollection.Count() &gt; 0)
{
  //gets the root term, 'value'
  Term term = termCollection.First();
  NavigationTerm navTerm = NavigationTerm.GetAsResolvedByWeb(term, web, "GlobalNavigationTaxonomyProvider");
  string friendlyUrl = navTerm.FriendlyUrlSegment.Value;
}
</code></pre>
<p>If you want to go the other direction, from the physical page to the friendly URL you would used the following code snippet.</p>
<pre><code>//get the pages library
Guid pagesId = PublishingWeb.GetPagesListId(web);
SPList publishingPages = web.Lists[pagesId];

//get a reference to whichever page you want
SPListItem page = publishingPages.Item[0];

//a page can have multiple friendly URLs
IList&lt;NavigationTerm&gt; friendlyUrls = new List&lt;NavigationTerm&gt;();
friendlyUrls = TaxonomyNavigation.GetFriendlyUrlsForListItem(page, true);
</code></pre>
<p>To set the target URL programmatically, you have to set the Value property of the Navigation Term’s TargetUrl property.  In this example, I’m using a hard coded physical URL, you would most likely get this value dynamically.</p>
<pre><code>NavigationTerm navTerm = NavigationTerm.GetAsResolvedByWeb(term, web, "GlobalNavigationTaxonomyProvider");
navTerm.TargetUrl.Value = "~sitecollection/Pages/testpage.aspx";
</code></pre>
<p>Just for good measure, below is a code snippet for getting the Navigation Term and friendly URL and setting the TargetUrl property using Powershell if you prefer to go that route.</p>
<pre><code>$taxonomySite = Get-SPSite -Identity $SiteUrl
$taxonomySession = Get-SPTaxonomySession -site $taxonomySite
$taxonomyTermStore =  $taxonomySession.TermStores | Select Name
$termStore = $taxonomySession.TermStores[$taxonomyTermStore.Name]

#make sure these 2 lines match your environment
$group = $termStore.Groups["Group name"]
$termSet = $group.TermSets["Term set name"]

foreach ($term in $termSet.GetAllTerms())
{
  $navTerm = [Microsoft.SharePoint.Publishing.Navigation.NavigationTerm]::GetAsResolvedByWeb($term, $taxonomySite.RootWeb, "GlobalNavigationTaxonomyProvider")

  #get friendly URL
  $friendlyUrl = $navTerm.FriendlyUrlSegment.Value


  #to set target URL
  $navTerm.TargetUrl.Value = "~sitecollection/Pages/testpage.aspx"
}

#to save all changes you made to term set
$termStore.CommitAll()
</code></pre>
<p>Again, if you want to go the other direction using Powershell, see below.</p>
<pre><code>#Get the Publishing Web and pages within it
$pagesId = [Microsoft.SharePoint.Publishing.PublishingWeb]::GetPagesListId($web)
$publishingPages = $web.Lists[$pagesId]
$page = $publishingPages.Items[0]

$friendlyUrls = [Microsoft.SharePoint.Publishing.Navigation.TaxonomyNavigation]::GetFriendlyUrlsForListItem($page, $true)
 
if ($friendlyUrls.Count -ne $zero)
{
  $friendlyUrls | ForEach-Object{
  $friendlyUrl = $_.GetWebRelativeFriendlyUrl()

  #code here for what you want to do w/ the friendly URL
}
 
#if you want to access a navigation property like below
$field = $page.Fields["Hide physical URLs from search"]
$physUrlHidden = $page.GetFormattedValue($field.Title)]
</code></pre>
</div> <br> <p class="BlogPost-publishDate"><em>Published May 02 2013</em></p></div></div></main></div></div><script type="text/javascript" src="/static/js/manifest.2ae2e69a05c33dfc65f8.js"></script><script type="text/javascript" src="/static/js/vendor.bdfbbe384b0395b368c1.js"></script><script type="text/javascript" src="/static/js/app.ab240af6d075b4ac57ad.js"></script></body></html>